<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Union Bank Canteen Admin Dashboard">
    <meta name="author" content="Union Bank IT Department">
    <title>Admin Dashboard - Union Bank Canteen</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/admin.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="shortcut icon" href="../images/LOGO.jpeg" type="image/x-icon">
    <script>
        // Check if user is logged in and is admin
        document.addEventListener('DOMContentLoaded', function() {
            if (!isLoggedIn()) {
                window.location.href = 'login.html';
                return;
            }
            
            if (!isAdmin()) {
                alert('You do not have permission to access the admin dashboard.');
                window.location.href = 'index.html';
                return;
            }
            
            // If we get here, user is logged in and is admin
            console.log('Admin authenticated successfully');
        });
        
        function isLoggedIn() {
            return sessionStorage.getItem('user') !== null;
        }
        
        function isAdmin() {
            try {
                const user = JSON.parse(sessionStorage.getItem('user'));
                console.log('User role:', user.role);
                return user && user.role === 'admin';
            } catch (error) {
                console.error('Error checking admin status:', error);
                return false;
            }
        }
    </script>
</head>
<body class="admin-body">
    <!-- Theme Toggle Button removed from here and moved to header -->

    <div class="admin-container">
        <!-- Mobile Menu Toggle -->
        <button id="sidebarToggle" class="sidebar-toggle">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar Overlay -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>
        
        <!-- Sidebar -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <img src="../images/LOGO.jpeg" alt="Union Bank Logo">
                <h2>Admin Panel</h2>
            </div>
            
            <nav class="sidebar-nav">
                <ul>
                    <li class="active" data-tab="dashboard">
                        <a href="#"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                    </li>
                    <li data-tab="menu-management">
                        <a href="#"><i class="fas fa-utensils"></i> Menu Management</a>
                    </li>
                    <li data-tab="order-management">
                        <a href="#"><i class="fas fa-clipboard-list"></i> Order Management</a>
                    </li>
                    <li data-tab="user-management">
                        <a href="#"><i class="fas fa-users"></i> User Management</a>
                    </li>
                    <li data-tab="reports">
                        <a href="#"><i class="fas fa-chart-bar"></i> Reports</a>
                    </li>
                </ul>
            </nav>
            
            <div class="sidebar-footer">
                <a href="index.html" class="back-to-site">
                    <i class="fas fa-arrow-left"></i> Back to Site
                </a>
                <a href="#" id="adminLogoutBtn" class="admin-logout">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="admin-main">
            <header class="admin-header">
                <div class="admin-header-title">
                    <h1 id="pageTitle">Dashboard</h1>
                </div>
                <div class="admin-header-user">
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                    <span id="headerAdminName">Admin User</span>
                    <div class="admin-avatar" id="headerAdminAvatar"><span>A</span></div>
                </div>
            </header>
            
            <!-- Dashboard Tab -->
            <section class="admin-content active" id="dashboard">
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-details">
                            <h3>Total Orders</h3>
                            <p class="stat-value">124</p>
                            <p class="stat-change positive">+12% from last week</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <div class="stat-details">
                            <h3>Revenue</h3>
                            <p class="stat-value">₦152,450</p>
                            <p class="stat-change positive">+8% from last week</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-details">
                            <h3>Active Users</h3>
                            <p class="stat-value">45</p>
                            <p class="stat-change positive">+5% from last week</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <div class="stat-details">
                            <h3>Menu Items</h3>
                            <p class="stat-value">28</p>
                            <p class="stat-change neutral">No change</p>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-recent">
                    <div class="recent-orders">
                        <div class="section-header">
                            <h2>Recent Orders</h2>
                            <a href="#" class="view-all" data-tab="order-management">View All</a>
                        </div>
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Customer</th>
                                        <th>Date</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>#ORD-2025-1234</td>
                                        <td>John Doe</td>
                                        <td>May 22, 2025</td>
                                        <td>₦3,500</td>
                                        <td><span class="status-badge pending">Pending</span></td>
                                    </tr>
                                    <tr>
                                        <td>#ORD-2025-1233</td>
                                        <td>Jane Smith</td>
                                        <td>May 22, 2025</td>
                                        <td>₦2,800</td>
                                        <td><span class="status-badge processing">Processing</span></td>
                                    </tr>
                                    <tr>
                                        <td>#ORD-2025-1232</td>
                                        <td>Robert Johnson</td>
                                        <td>May 21, 2025</td>
                                        <td>₦1,500</td>
                                        <td><span class="status-badge completed">Completed</span></td>
                                    </tr>
                                    <tr>
                                        <td>#ORD-2025-1231</td>
                                        <td>Emily Davis</td>
                                        <td>May 21, 2025</td>
                                        <td>₦4,200</td>
                                        <td><span class="status-badge completed">Completed</span></td>
                                    </tr>
                                    <tr>
                                        <td>#ORD-2025-1230</td>
                                        <td>Michael Wilson</td>
                                        <td>May 20, 2025</td>
                                        <td>₦2,100</td>
                                        <td><span class="status-badge cancelled">Cancelled</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="popular-items">
                        <div class="section-header">
                            <h2>Popular Items</h2>
                            <a href="#" class="view-all" data-tab="reports">View Report</a>
                        </div>
                        <div class="popular-items-list">
                            <div class="popular-item">
                                <img src="../images/jollof-rice.jpg" alt="Jollof Rice">
                                <div class="popular-item-details">
                                    <h3>Jollof Rice & Chicken</h3>
                                    <p>Ordered 42 times this week</p>
                                </div>
                                <div class="popular-item-stats">
                                    <div class="progress-bar">
                                        <div class="progress" style="width: 85%;"></div>
                                    </div>
                                    <span>85%</span>
                                </div>
                            </div>
                            
                            <div class="popular-item">
                                <img src="../images/fried-rice.jpg" alt="Fried Rice">
                                <div class="popular-item-details">
                                    <h3>Fried Rice & Fish</h3>
                                    <p>Ordered 36 times this week</p>
                                </div>
                                <div class="popular-item-stats">
                                    <div class="progress-bar">
                                        <div class="progress" style="width: 72%;"></div>
                                    </div>
                                    <span>72%</span>
                                </div>
                            </div>
                            
                            <div class="popular-item">
                                <img src="../images/sandwich.jpg" alt="Chicken Sandwich">
                                <div class="popular-item-details">
                                    <h3>Chicken Sandwich</h3>
                                    <p>Ordered 28 times this week</p>
                                </div>
                                <div class="popular-item-stats">
                                    <div class="progress-bar">
                                        <div class="progress" style="width: 56%;"></div>
                                    </div>
                                    <span>56%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Menu Management Tab -->
            <section class="admin-content" id="menu-management">
                <div class="content-header">
                    <h2>Menu Management</h2>
                    <button class="primary-btn" id="addMenuItemBtn">
                        <i class="fas fa-plus"></i> Add New Item
                    </button>
                </div>
                
                <div class="menu-categories-filter">
                    <button class="category-filter active" data-category="all">All Categories</button>
                    <button class="category-filter" data-category="main">Main Dishes</button>
                    <button class="category-filter" data-category="sides">Side Dishes</button>
                    <button class="category-filter" data-category="drinks">Drinks</button>
                    <button class="category-filter" data-category="desserts">Desserts</button>
                </div>
                
                <div class="menu-items-grid" id="menuItemsGrid">
                    <!-- Menu items will be loaded here dynamically as cards -->
                </div>
            </section>
            
            <!-- Order Management Tab -->
            <section class="admin-content" id="order-management">
                <div class="content-header">
                    <h2>Order Management</h2>
                    <div class="order-filters">
                        <select id="orderStatusFilter" class="filter-select">
                            <option value="all">All Statuses</option>
                            <option value="pending">Pending</option>
                            <option value="processing">Processing</option>
                            <option value="ready">Ready</option>
                            <option value="completed">Completed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                        <input type="date" id="orderDateFilter" class="filter-date">
                        <button class="secondary-btn" id="refreshOrdersBtn">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                    </div>
                </div>
                
                <div class="orders-grid" id="ordersGrid">
                    <!-- Orders will be loaded here dynamically as cards -->
                </div>
            </section>
            
            <!-- User Management Tab -->
            <section class="admin-content" id="user-management">
                <div class="content-header">
                    <h2>User Management</h2>
                    <button class="primary-btn" id="addUserBtn">
                        <i class="fas fa-user-plus"></i> Add New User
                    </button>
                </div>
                
                <div class="users-grid" id="usersGrid">
                    <!-- Users will be loaded here dynamically as cards -->
                </div>
            </section>
            
            <!-- Reports Tab -->
            <section class="admin-content" id="reports">
                <div class="content-header">
                    <h2>Reports</h2>
                    <div class="report-filters">
                        <select id="reportTypeFilter" class="filter-select">
                            <option value="sales">Sales Report</option>
                            <option value="popular">Popular Items</option>
                            <option value="users">User Activity</option>
                        </select>
                        <select id="reportPeriodFilter" class="filter-select">
                            <option value="daily">Daily</option>
                            <option value="weekly" selected>Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                        <button class="secondary-btn" id="generateReportBtn">
                            <i class="fas fa-file-export"></i> Generate Report
                        </button>
                    </div>
                </div>
                
                <div class="reports-container">
                    <div class="report-card">
                        <div class="report-card-header">
                            <h3>Weekly Sales Chart</h3>
                        </div>
                        <div class="report-chart-container">
                            <canvas id="reportChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-card-header">
                            <h3>Weekly Sales Summary</h3>
                        </div>
                        <div class="summary-stats">
                            <div class="summary-stat">
                                <span class="stat-label">Total Sales</span>
                                <span class="stat-value">₦152,450</span>
                            </div>
                            <div class="summary-stat">
                                <span class="stat-label">Orders</span>
                                <span class="stat-value">124</span>
                            </div>
                            <div class="summary-stat">
                                <span class="stat-label">Avg. Order Value</span>
                                <span class="stat-value">₦1,229</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-card">
                        <div class="report-card-header">
                            <h3>Top Selling Items</h3>
                        </div>
                        <div class="top-items-list">
                            <div class="top-item">
                                <div class="top-item-rank">1</div>
                                <div class="top-item-details">
                                    <h4>Jollof Rice & Chicken</h4>
                                    <p>42 orders this week</p>
                                </div>
                                <div class="top-item-value">₦63,000</div>
                            </div>
                            <div class="top-item">
                                <div class="top-item-rank">2</div>
                                <div class="top-item-details">
                                    <h4>Fried Rice & Fish</h4>
                                    <p>36 orders this week</p>
                                </div>
                                <div class="top-item-value">₦64,800</div>
                            </div>
                            <div class="top-item">
                                <div class="top-item-rank">3</div>
                                <div class="top-item-details">
                                    <h4>Chicken Sandwich</h4>
                                    <p>28 orders this week</p>
                                </div>
                                <div class="top-item-value">₦33,600</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <!-- Add Menu Item Modal -->
    <div class="modal" id="addMenuItemModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Menu Item</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addMenuItemForm">
                    <div class="form-group">
                        <label for="itemName">Item Name</label>
                        <input type="text" id="itemName" name="itemName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemCategory">Category</label>
                        <select id="itemCategory" name="itemCategory" required>
                            <option value="">Select Category</option>
                            <option value="main">Main Dish</option>
                            <option value="sides">Side Dish</option>
                            <option value="drinks">Drink</option>
                            <option value="desserts">Dessert</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemPrice">Price (₦)</label>
                        <input type="number" id="itemPrice" name="itemPrice" min="0" step="50" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemDescription">Description</label>
                        <textarea id="itemDescription" name="itemDescription" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemImage">Image URL</label>
                        <input type="text" id="itemImage" name="itemImage" placeholder="Enter image URL or upload">
                        <div class="upload-btn-wrapper">
                            <button class="upload-btn">Upload Image</button>
                            <input type="file" id="imageUpload" accept="image/*">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="itemAvailable" name="itemAvailable" checked>
                            <span class="checkbox-custom"></span>
                            Available for ordering
                        </label>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="secondary-btn cancel-modal">Cancel</button>
                        <button type="submit" class="primary-btn">Add Item</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- View/Edit Order Modal -->
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Order Details</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="order-details">
                    <div class="order-info">
                        <div class="order-info-group">
                            <span class="info-label">Order ID:</span>
                            <span class="info-value" id="orderIdDisplay">#ORD-2025-1234</span>
                        </div>
                        <div class="order-info-group">
                            <span class="info-label">Date & Time:</span>
                            <span class="info-value" id="orderDateDisplay">May 22, 2025, 10:30 AM</span>
                        </div>
                        <div class="order-info-group">
                            <span class="info-label">Customer:</span>
                            <span class="info-value" id="orderCustomerDisplay">John Doe</span>
                        </div>
                        <div class="order-info-group">
                            <span class="info-label">Department:</span>
                            <span class="info-value" id="orderDepartmentDisplay">Finance</span>
                        </div>
                        <div class="order-info-group">
                            <span class="info-label">Status:</span>
                            <select id="orderStatusSelect" class="status-select">
                                <option value="pending">Pending</option>
                                <option value="processing">Processing</option>
                                <option value="ready">Ready for Pickup</option>
                                <option value="completed">Completed</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="order-items">
                        <h3>Order Items</h3>
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>Item</th>
                                        <th>Price</th>
                                        <th>Quantity</th>
                                        <th>Subtotal</th>
                                    </tr>
                                </thead>
                                <tbody id="orderItemsTableBody">
                                    <!-- Order items will be loaded here dynamically -->
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="3" class="text-right"><strong>Total:</strong></td>
                                        <td id="orderTotalDisplay">₦3,500</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                    
                    <div class="order-notes">
                        <h3>Notes</h3>
                        <textarea id="orderNotes" rows="3" placeholder="Add notes about this order..."></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="danger-btn" id="cancelOrderBtn">Cancel Order</button>
                        <button type="button" class="primary-btn" id="updateOrderBtn">Update Order</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="js/admin.js"></script>
    <script src="js/script.js"></script>
</body>
</html>
